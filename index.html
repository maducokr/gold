<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
  <meta name="mobile-web-app-capable" content="yes"/>
  <title>골든 코인 투하 게임</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      text-align: center;
      background: url('gold.png') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 0;
      height: 100vh;
      width: 100vw;
      position: fixed;
      top: 0;
      left: 0;
      overflow: hidden;
      touch-action: none;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-overflow-scrolling: touch;
    }
    
    #coinCount {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(255, 215, 0, 0.95);
      color: #333;
      padding: 12px 24px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: bold;
      z-index: 100;
      backdrop-filter: blur(10px);
      border: 2px solid #FFD700;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      width: fit-content;
      max-width: calc(100% - 40px);
      white-space: nowrap;
    }
    

    
    #scoreBoard {
      position: fixed;
      font-size: 14px;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(255, 255, 255, 0.95);
      padding: 8px 16px;
      border-radius: 15px;
      display: inline-block;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 99;
    }
    
    h1, p {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 10px 16px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      display: inline-block;
      font-size: 12px;
      margin: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }
    
    h1 {
      font-size: 14px;
      margin-top: 120px;
      font-weight: bold;
    }
    
    #movingDish {
      position: absolute;
      width: 80px;
      height: 80px;
      z-index: 5;
      transition: all 0.8s ease-in-out;
      cursor: pointer;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    }
    
    @media (max-width: 480px) {
      #movingDish {
        width: 70px;
        height: 70px;
      }
    }
    
    #coinButton {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(45deg, #FFD700, #FFA500);
      color: #333;
      border: none;
      padding: 18px 36px;
      border-radius: 30px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      transition: all 0.2s ease;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      min-width: 160px;
      min-height: 60px;
    }
    
    #coinButton:hover {
      transform: translateX(-50%) scale(1.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
    }
    
    #coinButton:active {
      transform: translateX(-50%) scale(0.95);
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    }
    
    @media (max-width: 480px) {
      #coinButton {
        bottom: 20px;
        padding: 16px 32px;
        font-size: 16px;
        min-width: 140px;
        min-height: 56px;
      }
    }
    
    .coin {
      position: absolute;
      font-size: 50px;
      z-index: 15;
      animation: fallDown 3s linear forwards, sparkle 1s infinite;
      pointer-events: none;
      top: -50px;
      touch-action: none;
    }
    
    @media (max-width: 480px) {
      .coin {
        font-size: 40px;
      }
    }
    @keyframes fallDown {
      0% {
        top: -50px;
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 1;
        transform: scale(1.1);
      }
      100% {
        top: 100vh;
        opacity: 0;
        transform: scale(0.8);
      }
    }
    @keyframes sparkle {
      0%   { filter: brightness(1.5) drop-shadow(0 0 10px #fff6b0); }
      20%  { filter: brightness(2.5) drop-shadow(0 0 20px #fff6b0); }
      40%  { filter: brightness(1.2) drop-shadow(0 0 5px #fff6b0); }
      60%  { filter: brightness(2.2) drop-shadow(0 0 15px #fff6b0); }
      80%  { filter: brightness(1.2) drop-shadow(0 0 5px #fff6b0); }
      100% { filter: brightness(1.5) drop-shadow(0 0 10px #fff6b0); }
    }
  </style>
</head>
<body>
  
  <div id="coinCount">🪙 Gold Coin: 0  Total: 0$</div>
  <img id="movingDish" src="dish.png" alt="dish" style="display:block;" />
  <button id="coinButton">🪙 Drop Coins</button>

  <script>
    const scoreBoard = document.getElementById("scoreBoard");
    const movingDish = document.getElementById("movingDish");
    const coinButton = document.getElementById("coinButton");
    const coinCount = document.getElementById("coinCount");
    let score = 0;
    let gameOver = false;
    let totalCoins = 0;
    
    // 모바일 터치 이벤트 지원
    let isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

    // 비행접시 랜덤 이동 함수
    function moveDish() {
      if (gameOver) return;
      const dishWidth = isTouchDevice ? 70 : 80;
      const dishHeight = isTouchDevice ? 70 : 80;
      const maxX = window.innerWidth - dishWidth;
      const maxY = window.innerHeight - 150; // 버튼 공간 확보
      const newX = Math.max(0, Math.min(maxX, Math.random() * maxX));
      const newY = Math.max(0, Math.min(maxY, Math.random() * maxY));
      movingDish.style.left = newX + 'px';
      movingDish.style.top = newY + 'px';
    }

    let dishInterval = null;
    function startDishMove() {
      if (dishInterval) clearInterval(dishInterval);
      moveDish();
      dishInterval = setInterval(moveDish, isTouchDevice ? 2500 : 3000);
    }
    function stopDishMove() {
      if (dishInterval) clearInterval(dishInterval);
      dishInterval = null;
    }

    // 금괴 떨어뜨리기 함수
    function dropCoins() {
      // 버튼 클릭 시 점수 초기화
      score = 0;
      const coinAmount = Math.floor(Math.random() * 101); // 0-100개
      totalCoins = coinAmount;
      updateCoinCount();
      // 비행접시 멈춤
      stopDishMove();
      let finished = 0;
      if (coinAmount === 0) {
        // 아무 금괴도 없으면 바로 재시작
        startDishMove();
        return;
      }
     
      
      for (let i = 0; i < coinAmount; i++) {
      
        setTimeout(() => {
          const coin = document.createElement("div");
          coin.classList.add("coin");
          const coinSize = isTouchDevice ? 40 : 50;
          coin.innerHTML = `<svg width="${coinSize}" height="${coinSize * 0.67}" viewBox="0 0 60 40">
            <ellipse cx="30" cy="20" rx="28" ry="16" fill="#FFD700" stroke="#B8860B" stroke-width="6"/>
            <ellipse cx="30" cy="20" rx="20" ry="10" fill="#FFC300" opacity="0.8"/>
          </svg>`;
          // 랜덤한 시작 위치 (화면 상단)
          const startX = Math.random() * window.innerWidth;
          coin.style.left = startX + 'px';
          coin.style.top = '-50px';
          document.body.appendChild(coin);
          score = i * 1000;
          updateCoinCount();
          // 애니메이션 완료 후 제거
          setTimeout(() => {
            if (coin.parentNode) {
              coin.parentNode.removeChild(coin);
            }
            finished++;
            if (finished === coinAmount) {
              // 모든 금괴가 떨어진 후 점수 초기화 및 비행접시 재시작
             
              startDishMove();
            }
          }, 3000);
        }, i * (isTouchDevice ? 80 : 100)); // 모바일에서는 더 빠르게

        
      }
    
    }

    // 금괴 개수 업데이트
    function updateCoinCount() {
      const displayText = isTouchDevice 
        ? `🪙 ${totalCoins}개  $${score+1000}`
        : `🪙 Gold Coin: ${totalCoins}  Total : ${score+1000}$`;
      coinCount.textContent = displayText;
    }

    // 초기 비행접시 위치 설정
    startDishMove();

    // 버튼 클릭/터치 이벤트
    coinButton.addEventListener("click", dropCoins);
    coinButton.addEventListener("touchend", function(e) {
      e.preventDefault();
      dropCoins();
    });
    
    // 비행접시 클릭/터치 이벤트
    movingDish.addEventListener("click", function() {
      window.open("");
    });
    movingDish.addEventListener("touchend", function(e) {
      e.preventDefault();
      window.open("");
    });
    
    // 화면 크기 변경 시 비행접시 위치 재조정
    window.addEventListener('resize', function() {
      if (!gameOver) {
        setTimeout(moveDish, 100);
      }
    });
    
    // 페이지 로드 완료 후 스크롤 위치 고정
    window.addEventListener('load', function() {
      window.scrollTo(0, 0);
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    });
    
    // 모바일에서 스크롤 방지
    document.addEventListener('touchmove', function(e) {
      e.preventDefault();
    }, { passive: false });
    
    // 추가 스크롤 방지 이벤트들
    document.addEventListener('touchstart', function(e) {
      e.preventDefault();
    }, { passive: false });
    
    document.addEventListener('touchend', function(e) {
      e.preventDefault();
    }, { passive: false });
    
    // 화면 방향 변경 시에도 고정
    window.addEventListener('orientationchange', function() {
      setTimeout(function() {
        window.scrollTo(0, 0);
      }, 100);
    });
    
    // 초기 스크롤 위치 고정
    window.scrollTo(0, 0);
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;


  </script>
</body>
</html>